\documentclass[runningheads]{AIIT}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\definecolor{rclr}{rgb}{0.5,0.1,0.1}
\definecolor{eclr}{rgb}{0,0.5,0.5}
\colorlet{acolor}{blue}
\colorlet{rcolor}{red}
\definecolor{ncolor}{rgb}{0.5,0.5,0.1}
\newcommand{\aaa}[2][acolor]{\noindent\textcolor{eclr}%
{+\ [}\textcolor{#1}{#2}\textcolor{eclr}{]}}
\newcommand{\rrr}[2][rcolor]{\noindent%
\textcolor{eclr}{-\ [}\textcolor{#1}{#2}\textcolor{eclr}{]}}
\newcommand{\nnn}[2][rcolor]{\noindent%
\textcolor{eclr}{}\textcolor{#1}{#2}\textcolor{eclr}{}}

\usepackage{hyperref}
\hypersetup{
    bookmarks=true,         % show bookmarks bar?
    unicode=true,           % non-Latin characters in Acrobat’s bookmarks
    pdftoolbar=true,        % show Acrobat’s toolbar?
    pdfmenubar=true,        % show Acrobat’s menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={FitH},    % fits the width of the page to the window
    pdftitle={Expert System for Structural Analysis\\ of Electrocardiogramms},    % title
    pdfauthor={Kristina Krasovitskaya, Evgeny Cherkashin},     % author
    pdfsubject={Electro cardio signal processing and recognition},   % subject of the document
    pdfcreator={EMACS-24.5:AuCTeX-0.89},   % creator of the document
    pdfproducer={PdfLaTeX}, % producer of the document
    pdfkeywords={Искусственный интеллект} {Логическое
      программирование} {Планирование действий} {Удовлетворение
      ограничений} {Компьютерная алгебра} {Принцип максимума} {Оптимальное управление}, % list of keywords
    pdfnewwindow=true,      % links in new window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=black,          % color of internal links (black)
    citecolor=black,        % color of links to bibliography
    filecolor=black,      % color of file links
    urlcolor=black           % color of external links
}


%% Necessary definitions for the running heads
\def\journalissue{International Conference on Applied Internet and Information Technologies, 2016}
\def\paperidnum{DOI: N/A}
\setcounter{page}{1}

\title{Expert System for Structural Analysis\\ of Electrocardiogramms}

%% Use this if the title is too long for the running heads
\titlerunning{Expert System for ECS}

\author{Kristina Krasovitskaya\inst{1} \and Evgeny Cherkashin\inst{2}}

%% Use this the list of authors is too long for the running heads
%\authorrunning{First Author et al.}

\institute{National Research Irkutsk State Technical University,\\
Lermontov str. 83, Irkutsk, 664078, Russian Federation\\
  \email{author1@institute.org}
  \and
Institute of System Dynamics and Control Theory at Siberian Branch of Russian Academy of Sciences,\\
Lermontov str. 134, Irkutsk, 664033, Russian Federation\\
  \email{eugeneai@icc.ru}}
\begin{document}
%\selectlanguage{}
\maketitle

\begin{abstract}
The paper deals with process of a cardiological expert system development. A definition of a electrocardiogram is presented. Problems of ECG characteristics determination such as ECG data digitizing is considered. A problem of QRS complex recognition and P and T waves parameters measurement is discussed. A general outline of analysis technique for ECG using wavelet transformation are proposed.

\vspace{6pt}\textbf{Keywords:} keyword1, keyword2.
\end{abstract}

\section{Introduction}

Medical images are popular objects of automatic analysis.  An image of a cardiogram contains time series of a cardiosignals, which are processed simultaneously and synchronous.  Manual static analysis contains a number of stages \nnn{like \dots}.  The signal processing software delivered with a cardiological diagnosis is intended for experienced users and tightly bound to the appliance version, resulting to impossibility to make a comparative analysis of elecro cardiograms of the same patient obtained in different medical centers and time moments.  This, in turn, requires additional observations to be carried on the patient to obtain the time series in the \nnn{needed} format, increasing the cost of the patient residence in the diagnostic center.  Also, Russia has regions where the specialized professional cardiological treatment is not possible, this can produce complications due to, e.g., delays.

Ministry of Health of Russian Federation started to elaborate of a law project aimed at a legal basis construction of IT infrastructure for public health protection.  The infrastructure will be based on remote interaction of medical professionals and patients.  At present the interaction (such as remote consultations) is out of professional moderation and provided via forums, specialized internet sites and Skype.  The cardiological data is supplied as attached photographic as scanned images.  The conclusion decision made in the environment are of question.

The automatic processing and analysis of the ECG will reduce human factor impact to resulting conclusion decision, since automatic processing results are not affected by the degree of fatigue, observation time, and body physical condition.  Moreover the results produced by human expert are usually intuitive, expressed in quality statements, and the reasoning process is hardly expressed as explicit elementary stages (algorithmic).  For example, the expert estimates the width of PQ interval to be shorter as compares to described in the literature, in addition the estimation varies among specialists.  Computer processing and analysis is significantly formalized and operates by qualitative values.




Уже более пятнадцати лет в сфере компьютерной обработки электрокардиосигнала проводятся исследования, но, как правило, каждый из методов обладает рядом недостатков, которые не позволяют осуществить его полноценное внедрение. Система «Валента» анализирует сигналы ЭКГ, однако ввести в неё данные с оборудования другой фирмы или же снятые другими аппаратами оцифрованные ленты возможности нет. Системы мониторного контроля, например, система контроля аритмий Argus, так же требуют наличия специального оборудования. Профессором д.м.н. В.М.Успенским предложен новый метод диагностики, позволяющий диагностировать широкий спектр заболеваний внутренних органов по ЭКГ.  Но и в этом случае алгоритм не охватывает существенную часть заболеваний сердца, основным проявлением которых являются аритмии. Только за последние три года процент страдающих аритмиями составил 8% . Ни одна из рассмотренных систем не обрабатывает бумажные электрокардиограммы, хотя сегодня этот вид носителя электрокардиоинформации остается самым популярным. Оцифровка лент ЭКГ так же позволяет сохранить важные диагностические данные в истории болезни и архиве пациента.

In this investigation we develop an IT technique and software, which will process and analyze ECG raster images obtained in cardiologist's offices, from medical organizations and medical histories.


\section{Structire of ECG}
\label{sec:structire-ecg}

\emph{Electrocardiogram} (ECG) is a graphical representation (a time series records) of impulse conduction on the nodes and bundles of the electrical conduction system of the heart.  The impulse conduction is recorded as a number of \emph{electrical entities} \cite{wikipedia} (\emph{pikes} made of rising and drooping, and \emph{horizontal segments}).  Pike entities are denoted by letters P, Q, R, S and T, whereas horizontal segments are denoted by PR segment and ST segment.

Each ECG analysis is started from verification of used registration process.  The registration of hearth electric field potential, named as \emph{lead}, is measured between two placements of the chest surface.  The standard ECG consists of twelve leads (vectors).

\begin{figure}[htb]
  \centering

  \caption{Standard twelve-lead ECG}
  \label{fig:leads-ex}
\end{figure}

\section{Image processing}
\label{sec:image-processing}

\subsection{Digitizing (recognition)}
\label{sec:digit-recogn}

% Time series digitizing
The first stage of the ECG image processing is recognition of the time series if the leads.  The source image scan consists of tracing paper background with square grid and lines of time series.  Time series include a reference pulse at the beginning (Fig.~\ref{fig:leads-ex}).  The processing of the image can be done with various techniques.  We started directly from the application of edge tracing algorithms do determine time series line, and obtained the results like depictured in Fig.~\ref{fig:sobel-ex}.

\begin{figure}[htb]
  \centering

  \caption{Sobel filter processing (inversed)}
  \label{fig:sobel-ex}
\end{figure}

As the image consists of the combination of the background and signal line, we decided to filter out the background \cite{1}.  The following algorithm implements the filtering.
\begin{enumerate}
\item A color channel of the background color is extracted from the source image.
\item A red image copy is blurred with Gaussian filter in the red channel.
\item The digital image of the lead time series is obtained using the following formula:
  $s(n)=f(n)+\sigma e(n)$, where $f(n)$ is the signal, $\sigma$ is the
  noise level, $e(n)$ is the Gaussian white noise, and $s(n)$ is the original
  signal.  The threshold transformation is applied to the image as well.
\item The signal recording is carried on in a cyclic processing \nnn{of the columns of the obtained array.}
\end{enumerate}
The algorithm did not produce results in all the test given.  Ten out of 156 ECGs did not completely analyzed due to threshold transformation function.  The function parameters were adjusted by means of a machine learning technique.  Hue and brightness characteristics of each column of the image were used as attributes of input train set.


\begin{figure}[htb]
  \centering

  \caption{Time series recognition algorithm stages}
  \label{fig:leads-ex}
\end{figure}

\subsection{Time series post processing}
\label{sec:cleaning-artefacts}

The original ECG image in a general case contains signal distortions such as baseline drift and proximity effect to energy supply network.  A similar low frequency distortion could also be introduces by the time series recognition algorithm.  The baseline drift arises due to patient's movement, electrode polarization, appliance measurement error, and bad electrode contact to patient's skin.  Removal of the low frequency distortions we used discrete Butterworth filter
$$
|H(k)|^2=\frac{1}{1+(k/k_c)^{2N}},
$$
where $H$ is frequency response of the analog filter, $k_c$ is a cutoff frequency (rad/s), $k$ is the analog frequency in radiant.  The energy supply network has usually 50 or 60 Hertz frequency, and its distortion is standard suppressed with band-stop and comb filters.

In the case when many copies of ECG is accessible, one can take advantage of synchronous and ensemble averaging techniques.  The noise is a stationary stochastic process, and the ECG signal itself is (quasi-) periodical or periodical-stationary.  Sliding mean filer in time space is applicable to a statistically stationary low frequency signals.  This technique provides filtering capabilities in real time.

If the real time mode is not required we use filtering in the frequency space.  If a power spectral density and autocorrelation function parameters are known, one can make use of optimal Wiener filter.  If the noise id not correlated with the signal or the distortion has nonstationary (or even stochastic) properties and there are no additional data, but we have a record from a secondary source, then adaptive filtering is used.

\section{ECG entities recognition}
\label{sec:ecg-etit-recogn}

\subsection{QRS complex detection}
\label{sec:qrs-compl-detect}

The QRS complex recognition is usually based on locating R pike with the following removal of the whole QRS complex from the ECG time series.  The R location is obtained by means of various methods, e.g., based on the derivative \cite{2}, sliding mean filer, weighted and quadratic operators of the first derivative \cite{3}, detection algorithm of Pan-Tompkins \cite{4}.  For PQRST complex detection, there are discrete wavelet transformation based algorithms \cite{5,6}, and \nnn{«по длительности»} transformations \cite{7}.

In this project we used discrete wavelet transformation method as it can determine pikes in the signals with base line drift distortion.  The previously recognized time series are loaded from a file and wavelet decomposition of \nnn{4th level} id carried on over the loaded data (Fig.~\ref{fig:decomp}, the source signal is decomposed with Daubechies wavelet.

\begin{figure}[htb]
  \centering

  \caption{Low frequencies decomposition}
  \label{fig:decomp}
\end{figure}

At the next processing stage the obtained time series analyzed visually by operator (user).  Then operator chooses the variant that is similar to the original time series.  The chosen variant contains no distortion.  Then the R pikes are determined as maximal values among time moments, where signal amplitude is greater of 60\% of the maximal value on the interval.

\begin{figure}[htb]
  \centering

  \caption{R pike determination}
  \label{fig:determ-R}
\end{figure}
The determined maximal values positions are also filtered according to pike average distance criterion.  The measured pike amplitude is corrected with respect to the bias of the original signal.  The determined locations the rest of the pikes are determined (Fig.\ref{fig:fig6} and \ref{fig:fig7}).

\begin{figure}[htb]
  \centering

  \caption{R pike determination (base line drift)}
  \label{fig:fig6}
\end{figure}

\begin{figure}[htb]
  \centering

  \caption{R pike determination (nondecomposed signal)}
  \label{fig:fig7}
\end{figure}

\section{Applications}
\label{sec:applications}

A comparative dynamics analysis of EGC of \nnn{abnormal} rhythms with various arrhythmia and conduction disorder has been carried on during patient observations of \nnn{первичных манифестаций нежелательных побочных реакций на многомесячную противотуберкулезную химиотерапию}.  The abnormalities are as follows (with the number of observations): ритм из правого предсердия (18 cases), атриовентрикулярная блокада I ст. (7 cases), полная блокада левой ножки пучка Гиса (2 cases), синдром Бругада (7 cases), синдром слабости синусового узла (1 case), миграция водителя ритма по предсердиям (2 cases), фибрилляция предсердий (10 cases), удлинение интервала Q–T (1 case), укорочение интервала P-Q – синдром  преждевременного возбуждения желудочков сердца Клерка–Леви–Кристеско (CLC) (12 cases), фатальный синдром  преждевременного возбуждения желудочков  Вольфа-Паркинсона-Вайта (WPW), тип «Б» (1 case), острый инфаркт миокарда с формированием патологического зубца Q (3 cases), острый инфаркт миокарда без зубца Q (-) но с подъёмом сегмента S-T (3 cases), синусовая тахикардия (4 cases), изолированный синдром ранней реполяризации желудочков (4 cases).

\nnn{Всем 78 больным на фоне начатой с момента поступления в стационар химиотерапии противотуберкулезными препаратами с учётом безопасности лекарственных взаимодействий назначены: внутримитохондриальный цитопротектор – мексидол инфузионно 1000 мг/сутки до 15 дней, амиодарон от 400 до 800 мг/сутки – для 10 до 10 дней, пропафенон от 450 до 900 мг/сутки – для 14 до 30 дней, бисопролол от 5 до 10 мг/сутки – для 12 до 30 дней, метопролола сукцинат от 25 до 50 мг/сутки  – для 28 до 30 дней, ивабрадин от 10 до 15 мг/сутки – для 16 пациентов. Электрокардиологический контроль проводился двукратно в течении первого месяца, далее – один раз в месяц. (Думаю, это не надо.)}

\section*{Conclusion}
It this paper we briefly described an IT technique for ECG image scans processing and their time series recognition.  The recognition result consists of P, Q, R, S and T section values expressed in qualitative terms, e.g., size, width, and amplitude.  The results \nnn{will be/are} used as fact data for expert system of structural analysis and interpretation in medical cardiological domains (ES ECG ``SERG'').  We analyzed 156 ECG images obtained by scanning ECG tapes.  The tapes are taken from archives of a hospital, ambulance brigades, and from patients \nnn{own} records.

\nnn{For some diagrams, a comparative analysis of ECG time dynamics and accompanying documentation  has been carried out. (\textbf{Это зачем?}) Удалось провести сравнительный количественный анализ изменения динамики электрокардиограмм представленных пациентами в сопроводитетельной документации, электрокардиографами приёмного покоя и стационарными в отделении функциональной диагностики.}

Врач функционалист now is able to give to a cardiologist an objectivate values of amplitudes and time intervals of P, Q, R, S and T pikes and the segments of clinically significant QRS complexes in millimeters and milliseconds, and in percent relations.  This resulted in rising the objectivity of dynamics evaluation with the domain criteria and coefficients, mentioned in manuals and textbooks on cardiology, but rare used in the real practice due to a lot of mathematical calculation and analysis.

\nnn{A} cardiologist carried on an analysis of amplitude dynamics of the amplitudes and the time intervals, and segments parameters, resulting in a safe rationalized \nnn{load} correction of medicaition dosage for only 2--3 days instead regular 5--6 ones.

The further development of the technique and its software and their implementation in practice of expert systems of the structural analysis of ECG will significantly improve the quality of cardiological monitoring of the patients with a complex comorbid disorders \nnn{in a interdisciplinary level}.

Литература:
%\bibliographystyle{splncs03}
%\bibliography{example}
 \begin{thebibliography}{99}
 \bibitem{wikipedia} Electrocardiography -- Wikipedia, the free encyclopedia. URL:\url{https://en.wikipedia.org/wiki/Electrocardiogram} (access date: 03.03.2016)

 \bibitem{1} Gonzalez, R.C., Woods, R.E., Eddins, S.L. Digital Image Processing Using MATLAB, 2nd ed. Gatesmark Publishing. 2009. 827~p.

 \bibitem{2} Ahlstrom M.L. and Tomhins W.J. Digital filters for real-time ECG signal processing using microprocessors // IEEE Trans. Biomed. Eng. – 1985. – V. 32. – P. 708-713.

 \bibitem{3} Murthy I.S.N. and Rangaraj M.R. New concepts for PVC detection // IEEE Trans. Biomed. Eng. – 1979. – V. 26, No. 7. – P. 409-416.

 \bibitem{4} Pan J. and Tomhins W.J. A real-time QRS detection algorithm // IEEE Trans. Biomed. Eng. – 1985. – V. 32. – P. 230-236.

 \bibitem{5} Khaled Daqrouq QRS Complex Detection Based on Symmlets Wavwlwt Function / Khaled Daqrouq, Ibrahim N. AbuIsbeih, Abdel-Rahman Al-Qawasmi // 5th International MultiConference on Systems, Signals and Devices – 2008

 \bibitem{6} Dubrovin V. I., Tverdohleb J. V., Kharchenko V. V. R-peaks detection using wavelet Technology // Радіоелектроніка, інформатика, управління . 2013. No.~2 (29). URL:\url{http://cyberleninka.ru/article/n/r-peaks-detection-using-wavelet-technology} (access date: 17.03.2016).

 \bibitem{7} Gritzali F., Frangakis G. and Papakonstantinou G. Detection of the P and T waves in an ECG // Comput. Biomed. Res. – 1976. – V. 9. – P. 125-132

 \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% For the final version of the paper: %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Author information
%\vspace{4ex}\noindent
%\textbf{Author One} is\dots
%
%\bigskip\noindent
%\textbf{Author Two} is\dots
%
%\bigskip\noindent
%\textbf{Author Three} is\dots

%% Reception and acceptance information
%\bigskip
%\paragraph{Received: Month DD, 20YY; Accepted: Month DD, 20YY.}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
